---
title: "MAGAMA-DC-DLAED2-learning"
date: 2025-02-18T19:30:30-04:00
categories:
  - blog
tags:
  - Jekyll
  - update
---

LAPACK的DLAED2函数: 用于DC分治法对于求解次数的缩减。

# 概述
LAPACK的DLAED2函数大体上明白了： 进行的缩减策略主要有2种，一种是相应的z=0的情况,一种是存在d相等的情况。
	其缩放是一起进行的;先查看相应的z是否等于0,如果等于0就直接缩放;如果不等于0再判断是否相等。

# 传递进来的参数：
	N:合并为的矩阵的尺寸.
	N1:开头的第1个子矩阵的尺寸
	D:存放两个子矩阵的特征值
	Q:存放两个子矩阵的特征向量
	INDXQ:存放两个子矩阵特征值特征向量的排列顺序
	RHO:存放进行秩1修正的系数
	Z：存放进行秩1修正的向量


# 处理的流程：
	1.如果RHO是负数,则将Z的第2个子矩阵对应的部分乘以-1，从而将RHO变成正的；
	2.对Z进行归1化;RHO也进行相应变化
	3.将INDXQ中第2个子矩阵对应的序号进行加N1;对D进行排序
	4.寻找Z中绝对值最大的元素,判断最大值是否也较小；如果较小就进行整体缩减；
	5.设置Q中每列特征向量对应的默认类型；
	6.进行缩减：从1到N进行循环判断,首先判断对应的z是否较小,若较小就直接进行缩减(将其序号存放到INDXP中)。
		若不小,则将这个序号记为PJ,再判断下1个元素；若下1个元素较小则缩减,若不小就对比这个元素和PJ对应的元素是否
		十分接近,若十分接近则将PJ对应z进行缩减,并将PJ赋值为NJ,中间会把PJ插入到INDXP的相应位置(注意是降序)。再进行下1个元素判断。
	7.处理最后1个特征值,存放最后1个D(PJ)到DLAMBDA,Z(PJ)到W中,PJ到INDXP中。(注意INDXP分为2部分,未缩减部分是升序,缩减部分是降序)
	8.记录不通种类的特征向量列的个数；设置不通类的位置
	9.按照类型存放不同列的序号
	10.将相应的Q按照类型复制到Q2的相应位置(注意:Q2为了后面计算矩阵乘法方便,对于CTOT(2)类型的列进行了特殊的存储;Q2中只存储了Q中非0的部分,其大小为
		N1*(CTOT(1)+CTOT(2)) + N2(CTOT(2)+CTOT(3)) + N*CTOT(4)。 )
	11.整理缩减后不需要再进行更新的特征向量和特征值到Q和D的后面N-K的部分。

# 传递出去的参数：
	DLAMBDA: 存放用于求secular方程的D
	W： 存放用于求scular方程的Z
	Q2: 存放变换后的特征值向量
	INDXC： 存放更新后的特征值向量的排序
